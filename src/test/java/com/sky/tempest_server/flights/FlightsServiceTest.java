package com.sky.tempest_server.flights;

import com.sky.tempest_server.flights.entities.Airport;
import com.sky.tempest_server.flights.services.FlightsService;
import com.sky.tempest_server.flights.services.TequilaAPIService;
import org.junit.runner.RunWith;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.MockitoJUnitRunner;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.http.HttpEntity;

import java.io.IOException;
import java.util.List;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.mockito.Mockito.*;


@SpringBootTest
@RunWith(MockitoJUnitRunner.class)
public class FlightsServiceTest {

    @Mock
    private TequilaAPIService mockTequilaAPIService;

    @InjectMocks
    private FlightsService flightsService;

    @org.junit.Test
    public void tests_searchAirports_response() throws IOException {
        final String tequilaAirportSearchTestResponseJson = "{\"locations\":[{\"id\":\"LGW\",\"int_id\":8949,\"airport_int_id\":8949,\"active\":true,\"code\":\"LGW\",\"icao\":\"EGKK\",\"name\":\"Gatwick\",\"slug\":\"gatwick-london-united-kingdom\",\"slug_en\":\"gatwick-london-united-kingdom\",\"alternative_names\":[\"Gatwick (London)\",\"London Gatwick (North Terminal)\"],\"rank\":17,\"global_rank_dst\":23,\"dst_popularity_score\":1407830.0,\"timezone\":\"Europe\\/London\",\"city\":{\"id\":\"london_gb\",\"name\":\"London\",\"code\":\"LON\",\"slug\":\"london-united-kingdom\",\"nearby_country\":null,\"autonomous_territory\":null,\"continent\":{\"id\":\"europe\",\"name\":\"Europe\",\"slug\":\"europe\",\"code\":\"EU\"},\"country\":{\"id\":\"GB\",\"name\":\"United Kingdom\",\"slug\":\"united-kingdom\",\"code\":\"GB\"},\"region\":{\"id\":\"northern-europe\",\"name\":\"Northern Europe\",\"slug\":\"northern-europe\"},\"subdivision\":null},\"location\":{\"lat\":51.148056,\"lon\":-0.190278},\"alternative_departure_points\":[{\"id\":\"SEN\",\"distance\":101.11,\"duration\":4740.5},{\"id\":\"LTN\",\"distance\":120.04,\"duration\":5264.8},{\"id\":\"STN\",\"distance\":121.4,\"duration\":5565.6},{\"id\":\"SOU\",\"distance\":144.28,\"duration\":6106.5},{\"id\":\"BOH\",\"distance\":186.14,\"duration\":7906.4},{\"id\":\"BHX\",\"distance\":231.22,\"duration\":9874.8},{\"id\":\"BRS\",\"distance\":232.58,\"duration\":10471.9},{\"id\":\"NWI\",\"distance\":249.24,\"duration\":10912.2},{\"id\":\"GB-BRIG-BRI1\",\"distance\":35.06,\"duration\":1616.9},{\"id\":\"GB-BRIG-BRI3\",\"distance\":36.15,\"duration\":1702.9},{\"id\":\"GB-BRIG-BRI2\",\"distance\":37.54,\"duration\":1843.7},{\"id\":\"GB-BRIG-BRIG\",\"distance\":39.44,\"duration\":2040},{\"id\":\"GB-HOVE-KING\",\"distance\":40.55,\"duration\":2122.6},{\"id\":\"GB-BRIG-BRI0\",\"distance\":41.36,\"duration\":2328.7},{\"id\":\"GB-HOVE-PORT\",\"distance\":42.16,\"duration\":2081.5},{\"id\":\"GB-SOUT-WEST\",\"distance\":43.84,\"duration\":2161},{\"id\":\"GB-LOND-WAND\",\"distance\":46.48,\"duration\":3044.4},{\"id\":\"GB-SHOR-SHOR\",\"distance\":47.66,\"duration\":2203},{\"id\":\"GB-LOND-ELEP\",\"distance\":48.43,\"duration\":3554.6},{\"id\":\"GB-LOND-WALW\",\"distance\":48.94,\"duration\":3727.4},{\"id\":\"GB-LOND-VICT\",\"distance\":48.97,\"duration\":3574},{\"id\":\"GB-SHOR-SHO0\",\"distance\":49.7,\"duration\":2335.6},{\"id\":\"LHR\",\"distance\":69.29,\"duration\":3305.5},{\"id\":\"LCY\",\"distance\":85.32,\"duration\":4193.5}],\"tags\":[{\"tag\":\"sightseeing\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"famous cities\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"activities\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"events\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"city break\",\"month_to\":-1,\"month_from\":-1}],\"providers\":[1035,1053,1165,1175,1277,1282,1283,1284,1329],\"special\":[{\"id\":\"natural-history-museum_poi\",\"name\":\"Natural History Museum\",\"slug\":\"natural-history-museum\"},{\"id\":\"st-paul-s-cathedral_poi\",\"name\":\"St. Paul's Cathedral\",\"slug\":\"st-paul-s-cathedral\"},{\"id\":\"tate-modern_poi\",\"name\":\"Tate Modern\",\"slug\":\"tate-modern\"},{\"id\":\"isle-of-wight_poi\",\"name\":\"Isle of Wight\",\"slug\":\"isle-of-wight\"},{\"id\":\"tower-of-london_poi\",\"name\":\"Tower of London\",\"slug\":\"tower-of-london\"},{\"id\":\"canterbury-cathedral_poi\",\"name\":\"Canterbury Cathedral\",\"slug\":\"canterbury-cathedral\"},{\"id\":\"british-museum_poi\",\"name\":\"British Museum\",\"slug\":\"british-museum\"},{\"id\":\"roman-baths-bath_poi\",\"name\":\"Roman Baths, Bath\",\"slug\":\"roman-baths\"},{\"id\":\"avebury_poi\",\"name\":\"Avebury\",\"slug\":\"avebury\"},{\"id\":\"portsea-island_poi\",\"name\":\"Portsea Island\",\"slug\":\"portsea-island\"},{\"id\":\"stonehenge_poi\",\"name\":\"Stonehenge\",\"slug\":\"stonehenge\"}],\"tourist_region\":[{\"id\":\"greater-london_poi\",\"name\":\"Greater London\",\"slug\":\"greater-london\"}],\"car_rentals\":[{\"provider_id\":1175,\"providers_locations\":[\"4435087\",\"4284212\"]}],\"new_ground\":false,\"routing_priority\":0,\"type\":\"airport\"},{\"id\":\"STN\",\"int_id\":813,\"airport_int_id\":813,\"active\":true,\"code\":\"STN\",\"icao\":\"EGSS\",\"name\":\"London Stansted\",\"slug\":\"london-stansted-london-united-kingdom\",\"slug_en\":\"london-stansted-london-united-kingdom\",\"alternative_names\":[],\"rank\":35,\"global_rank_dst\":54,\"dst_popularity_score\":711033.0,\"timezone\":\"Europe\\/London\",\"city\":{\"id\":\"london_gb\",\"name\":\"London\",\"code\":\"LON\",\"slug\":\"london-united-kingdom\",\"nearby_country\":null,\"autonomous_territory\":null,\"continent\":{\"id\":\"europe\",\"name\":\"Europe\",\"slug\":\"europe\",\"code\":\"EU\"},\"country\":{\"id\":\"GB\",\"name\":\"United Kingdom\",\"slug\":\"united-kingdom\",\"code\":\"GB\"},\"region\":{\"id\":\"northern-europe\",\"name\":\"Northern Europe\",\"slug\":\"northern-europe\"},\"subdivision\":null},\"location\":{\"lat\":51.885,\"lon\":0.235},\"alternative_departure_points\":[{\"id\":\"LGW\",\"distance\":120.54,\"duration\":5574.9},{\"id\":\"NWI\",\"distance\":143.49,\"duration\":6835.9},{\"id\":\"SOU\",\"distance\":191.65,\"duration\":8708.7},{\"id\":\"BHX\",\"distance\":194.02,\"duration\":8631.6},{\"id\":\"EMA\",\"distance\":200.75,\"duration\":8664.3},{\"id\":\"DSA\",\"distance\":232.75,\"duration\":10428.6},{\"id\":\"BOH\",\"distance\":233.51,\"duration\":10508.6},{\"id\":\"GB-BRAI-MARK\",\"distance\":34.91,\"duration\":1864.1},{\"id\":\"GB-CAMB-CAM2\",\"distance\":49.63,\"duration\":2695.9},{\"id\":\"LCY\",\"distance\":55.86,\"duration\":3186.5},{\"id\":\"LTN\",\"distance\":65.87,\"duration\":3992.5},{\"id\":\"SEN\",\"distance\":67.25,\"duration\":3848.4},{\"id\":\"LHR\",\"distance\":97.99,\"duration\":5113}],\"tags\":[{\"tag\":\"sightseeing\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"famous cities\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"activities\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"events\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"city break\",\"month_to\":-1,\"month_from\":-1}],\"providers\":[1053,1277,1282,1283,1284,1329],\"special\":[{\"id\":\"british-museum_poi\",\"name\":\"British Museum\",\"slug\":\"british-museum\"},{\"id\":\"portsea-island_poi\",\"name\":\"Portsea Island\",\"slug\":\"portsea-island\"},{\"id\":\"canterbury-cathedral_poi\",\"name\":\"Canterbury Cathedral\",\"slug\":\"canterbury-cathedral\"},{\"id\":\"natural-history-museum_poi\",\"name\":\"Natural History Museum\",\"slug\":\"natural-history-museum\"},{\"id\":\"stonehenge_poi\",\"name\":\"Stonehenge\",\"slug\":\"stonehenge\"},{\"id\":\"st-paul-s-cathedral_poi\",\"name\":\"St. Paul's Cathedral\",\"slug\":\"st-paul-s-cathedral\"},{\"id\":\"isle-of-wight_poi\",\"name\":\"Isle of Wight\",\"slug\":\"isle-of-wight\"},{\"id\":\"tower-of-london_poi\",\"name\":\"Tower of London\",\"slug\":\"tower-of-london\"},{\"id\":\"tate-modern_poi\",\"name\":\"Tate Modern\",\"slug\":\"tate-modern\"}],\"tourist_region\":[{\"id\":\"greater-london_poi\",\"name\":\"Greater London\",\"slug\":\"greater-london\"}],\"car_rentals\":[],\"new_ground\":false,\"routing_priority\":0,\"type\":\"airport\"},{\"id\":\"LHR\",\"int_id\":3940,\"airport_int_id\":3940,\"active\":true,\"code\":\"LHR\",\"icao\":\"EGLL\",\"name\":\"Heathrow\",\"slug\":\"heathrow-london-united-kingdom\",\"slug_en\":\"heathrow-london-united-kingdom\",\"alternative_names\":[\"Heathrow (London)\"],\"rank\":16,\"global_rank_dst\":6,\"dst_popularity_score\":4060457.0,\"timezone\":\"Europe\\/London\",\"city\":{\"id\":\"london_gb\",\"name\":\"London\",\"code\":\"LON\",\"slug\":\"london-united-kingdom\",\"nearby_country\":null,\"autonomous_territory\":null,\"continent\":{\"id\":\"europe\",\"name\":\"Europe\",\"slug\":\"europe\",\"code\":\"EU\"},\"country\":{\"id\":\"GB\",\"name\":\"United Kingdom\",\"slug\":\"united-kingdom\",\"code\":\"GB\"},\"region\":{\"id\":\"northern-europe\",\"name\":\"Northern Europe\",\"slug\":\"northern-europe\"},\"subdivision\":null},\"location\":{\"lat\":51.4775,\"lon\":-0.461389},\"alternative_departure_points\":[{\"id\":\"SOU\",\"distance\":100.93,\"duration\":4496.5},{\"id\":\"STN\",\"distance\":105.95,\"duration\":4956},{\"id\":\"SEN\",\"distance\":123.26,\"duration\":5624.5},{\"id\":\"BOH\",\"distance\":142.79,\"duration\":6296.4},{\"id\":\"BHX\",\"distance\":169.63,\"duration\":7438.9},{\"id\":\"BRS\",\"distance\":181.58,\"duration\":8299.7},{\"id\":\"EMA\",\"distance\":190.1,\"duration\":8034.3},{\"id\":\"GB-LOND-HAMM\",\"distance\":21.01,\"duration\":1463.1},{\"id\":\"NWI\",\"distance\":217.28,\"duration\":9887.9},{\"id\":\"CWL\",\"distance\":243.03,\"duration\":10545},{\"id\":\"EXT\",\"distance\":247.65,\"duration\":11020.3},{\"id\":\"GB-LOND-VICT\",\"distance\":26.06,\"duration\":1953.8},{\"id\":\"GB-LOND-BISH\",\"distance\":26.34,\"duration\":1933.2},{\"id\":\"GB-LOND-WAND\",\"distance\":26.65,\"duration\":1982.3},{\"id\":\"GB-LOND-MARB\",\"distance\":26.89,\"duration\":1972.9},{\"id\":\"GB-LOND-MAR0\",\"distance\":27.12,\"duration\":2010.7},{\"id\":\"GB-LOND-LON2\",\"distance\":27.64,\"duration\":2087},{\"id\":\"GB-LOND-STJO\",\"distance\":28.7,\"duration\":2185.6},{\"id\":\"GB-LOND-LON3\",\"distance\":29.11,\"duration\":2092},{\"id\":\"GB-LOND-ELEP\",\"distance\":30.17,\"duration\":2478.7},{\"id\":\"GB-LOND-FIN0\",\"distance\":30.96,\"duration\":2241.5},{\"id\":\"GB-LOND-FINC\",\"distance\":31.72,\"duration\":2329.1},{\"id\":\"GB-LOND-WALW\",\"distance\":32.19,\"duration\":2653.6},{\"id\":\"GB-LOND-SHOR\",\"distance\":32.53,\"duration\":2751.3},{\"id\":\"GB-LOND-WHIT\",\"distance\":33.25,\"duration\":2819.2},{\"id\":\"GB-LOND-BETH\",\"distance\":33.99,\"duration\":2975.1},{\"id\":\"GB-WATF-LOND\",\"distance\":34.13,\"duration\":2257.3},{\"id\":\"GB-LOND-NEWC\",\"distance\":34.93,\"duration\":2934.2},{\"id\":\"GB-LOND-MILE\",\"distance\":35.11,\"duration\":3006.5},{\"id\":\"GB-LOND-BOWW\",\"distance\":36.11,\"duration\":3109.5},{\"id\":\"GB-LOND-LEWI\",\"distance\":37.45,\"duration\":3209},{\"id\":\"GB-LOND-STR0\",\"distance\":38.84,\"duration\":3451.2},{\"id\":\"GB-GUIL-TESC\",\"distance\":39.49,\"duration\":1943.9},{\"id\":\"GB-HEME-BRID\",\"distance\":40.54,\"duration\":2077.1},{\"id\":\"LCY\",\"distance\":42.23,\"duration\":3713.8},{\"id\":\"GB-ELTH-WEST\",\"distance\":43.37,\"duration\":3628.9},{\"id\":\"GB-READ-MERE\",\"distance\":43.47,\"duration\":2070.2},{\"id\":\"GB-LEWK-TURN\",\"distance\":49.51,\"duration\":2172.4},{\"id\":\"LTN\",\"distance\":58.45,\"duration\":2828.9},{\"id\":\"LGW\",\"distance\":69.61,\"duration\":3275.9}],\"tags\":[{\"tag\":\"sightseeing\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"famous cities\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"activities\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"events\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"city break\",\"month_to\":-1,\"month_from\":-1}],\"providers\":[1035,1053,1096,1165,1175,1227,1229,1277,1282,1283,1284,1329],\"special\":[{\"id\":\"st-fagans-national-history-museum_poi\",\"name\":\"St Fagans: National History Museum\",\"slug\":\"st-fagans-national-history-museum\"},{\"id\":\"canterbury-cathedral_poi\",\"name\":\"Canterbury Cathedral\",\"slug\":\"canterbury-cathedral\"},{\"id\":\"british-museum_poi\",\"name\":\"British Museum\",\"slug\":\"british-museum\"},{\"id\":\"avebury_poi\",\"name\":\"Avebury\",\"slug\":\"avebury\"},{\"id\":\"isle-of-wight_poi\",\"name\":\"Isle of Wight\",\"slug\":\"isle-of-wight\"},{\"id\":\"tower-of-london_poi\",\"name\":\"Tower of London\",\"slug\":\"tower-of-london\"},{\"id\":\"portsea-island_poi\",\"name\":\"Portsea Island\",\"slug\":\"portsea-island\"},{\"id\":\"st-david-s-cathedral-cardiff_poi\",\"name\":\"St. David's Cathedral, Cardiff\",\"slug\":\"st-david-s-cathedral\"},{\"id\":\"tintern-abbey-united-kingdom_poi\",\"name\":\"Tintern Abbey, United Kingdom\",\"slug\":\"tintern-abbey\"},{\"id\":\"roman-baths-bath_poi\",\"name\":\"Roman Baths, Bath\",\"slug\":\"roman-baths\"},{\"id\":\"natural-history-museum_poi\",\"name\":\"Natural History Museum\",\"slug\":\"natural-history-museum\"},{\"id\":\"st-paul-s-cathedral_poi\",\"name\":\"St. Paul's Cathedral\",\"slug\":\"st-paul-s-cathedral\"},{\"id\":\"tate-modern_poi\",\"name\":\"Tate Modern\",\"slug\":\"tate-modern\"},{\"id\":\"stonehenge_poi\",\"name\":\"Stonehenge\",\"slug\":\"stonehenge\"}],\"tourist_region\":[{\"id\":\"greater-london_poi\",\"name\":\"Greater London\",\"slug\":\"greater-london\"}],\"car_rentals\":[{\"provider_id\":1175,\"providers_locations\":[\"245299\",\"164379\",\"4263809\",\"4343811\"]}],\"new_ground\":false,\"routing_priority\":0,\"type\":\"airport\"},{\"id\":\"LCY\",\"int_id\":9625,\"airport_int_id\":9625,\"active\":true,\"code\":\"LCY\",\"icao\":\"EGLC\",\"name\":\"London City\",\"slug\":\"london-city-london-united-kingdom\",\"slug_en\":\"london-city-london-united-kingdom\",\"alternative_names\":[\"City Airport (London)\"],\"rank\":220,\"global_rank_dst\":73,\"dst_popularity_score\":430820.0,\"timezone\":\"Europe\\/London\",\"city\":{\"id\":\"london_gb\",\"name\":\"London\",\"code\":\"LON\",\"slug\":\"london-united-kingdom\",\"nearby_country\":null,\"autonomous_territory\":null,\"continent\":{\"id\":\"europe\",\"name\":\"Europe\",\"slug\":\"europe\",\"code\":\"EU\"},\"country\":{\"id\":\"GB\",\"name\":\"United Kingdom\",\"slug\":\"united-kingdom\",\"code\":\"GB\"},\"region\":{\"id\":\"northern-europe\",\"name\":\"Northern Europe\",\"slug\":\"northern-europe\"},\"subdivision\":null},\"location\":{\"lat\":51.505,\"lon\":0.054167},\"alternative_departure_points\":[{\"id\":\"GB-LOND-BOWW\",\"distance\":10.38,\"duration\":1188.9},{\"id\":\"GB-LOND-STR0\",\"distance\":11.13,\"duration\":1342.2},{\"id\":\"GB-LOND-MILE\",\"distance\":11.51,\"duration\":1362},{\"id\":\"GB-LOND-WHIT\",\"distance\":11.89,\"duration\":1367.6},{\"id\":\"GB-LOND-BETH\",\"distance\":12.88,\"duration\":1441.5},{\"id\":\"GB-LOND-SHOR\",\"distance\":13.65,\"duration\":1578.4},{\"id\":\"SOU\",\"distance\":143.13,\"duration\":7952.1},{\"id\":\"GB-LOND-LEWI\",\"distance\":15.01,\"duration\":1709.6},{\"id\":\"GB-LOND-NEWC\",\"distance\":15.2,\"duration\":1682.1},{\"id\":\"GB-LOND-ELEP\",\"distance\":15.42,\"duration\":1736.8},{\"id\":\"GB-LOND-WALW\",\"distance\":15.74,\"duration\":1774.5},{\"id\":\"GB-ELTH-WEST\",\"distance\":16.05,\"duration\":1589.5},{\"id\":\"NWI\",\"distance\":182.26,\"duration\":8559},{\"id\":\"BOH\",\"distance\":184.99,\"duration\":9752},{\"id\":\"GB-LOND-VICT\",\"distance\":19.09,\"duration\":2296.8},{\"id\":\"GB-LOND-MARB\",\"distance\":19.42,\"duration\":2309.1},{\"id\":\"GB-LOND-MAR0\",\"distance\":19.48,\"duration\":2324.9},{\"id\":\"GB-LOND-LON2\",\"distance\":20.29,\"duration\":2355.3},{\"id\":\"BHX\",\"distance\":207.39,\"duration\":9303.9},{\"id\":\"EMA\",\"distance\":214.23,\"duration\":9341},{\"id\":\"GB-LOND-BISH\",\"distance\":21.49,\"duration\":2466.4},{\"id\":\"GB-LOND-STJO\",\"distance\":21.58,\"duration\":2493.3},{\"id\":\"BRS\",\"distance\":221.29,\"duration\":11678.4},{\"id\":\"GB-LOND-FINC\",\"distance\":23.69,\"duration\":2707.5},{\"id\":\"GB-LOND-HAMM\",\"distance\":24.25,\"duration\":2799.7},{\"id\":\"GB-LOND-WAND\",\"distance\":24.8,\"duration\":2710.1},{\"id\":\"GB-GRAV-BLUE\",\"distance\":29.93,\"duration\":2093.6},{\"id\":\"GB-LOND-LON3\",\"distance\":33.24,\"duration\":2420.9},{\"id\":\"GB-LOND-FIN0\",\"distance\":36.04,\"duration\":2697.5},{\"id\":\"GB-WATF-LOND\",\"distance\":39.13,\"duration\":2740.5},{\"id\":\"LHR\",\"distance\":44.88,\"duration\":4147.9},{\"id\":\"STN\",\"distance\":54.42,\"duration\":3212.4},{\"id\":\"SEN\",\"distance\":55.62,\"duration\":3265.4},{\"id\":\"LTN\",\"distance\":82.58,\"duration\":4135.6},{\"id\":\"LGW\",\"distance\":84.44,\"duration\":4316.5}],\"tags\":[{\"tag\":\"sightseeing\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"famous cities\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"activities\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"events\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"city break\",\"month_to\":-1,\"month_from\":-1}],\"providers\":[1175,1277,1284],\"special\":[{\"id\":\"portsea-island_poi\",\"name\":\"Portsea Island\",\"slug\":\"portsea-island\"},{\"id\":\"stonehenge_poi\",\"name\":\"Stonehenge\",\"slug\":\"stonehenge\"},{\"id\":\"british-museum_poi\",\"name\":\"British Museum\",\"slug\":\"british-museum\"},{\"id\":\"natural-history-museum_poi\",\"name\":\"Natural History Museum\",\"slug\":\"natural-history-museum\"},{\"id\":\"st-paul-s-cathedral_poi\",\"name\":\"St. Paul's Cathedral\",\"slug\":\"st-paul-s-cathedral\"},{\"id\":\"tate-modern_poi\",\"name\":\"Tate Modern\",\"slug\":\"tate-modern\"},{\"id\":\"avebury_poi\",\"name\":\"Avebury\",\"slug\":\"avebury\"},{\"id\":\"canterbury-cathedral_poi\",\"name\":\"Canterbury Cathedral\",\"slug\":\"canterbury-cathedral\"},{\"id\":\"tower-of-london_poi\",\"name\":\"Tower of London\",\"slug\":\"tower-of-london\"},{\"id\":\"isle-of-wight_poi\",\"name\":\"Isle of Wight\",\"slug\":\"isle-of-wight\"}],\"tourist_region\":[{\"id\":\"greater-london_poi\",\"name\":\"Greater London\",\"slug\":\"greater-london\"}],\"car_rentals\":[{\"provider_id\":1175,\"providers_locations\":[\"245314\",\"164389\",\"4397519\"]}],\"new_ground\":false,\"routing_priority\":0,\"type\":\"airport\"},{\"id\":\"SEN\",\"int_id\":8261,\"airport_int_id\":8261,\"active\":true,\"code\":\"SEN\",\"icao\":\"EGMC\",\"name\":\"London Southend\",\"slug\":\"london-southend-london-united-kingdom\",\"slug_en\":\"london-southend-london-united-kingdom\",\"alternative_names\":[],\"rank\":774,\"global_rank_dst\":478,\"dst_popularity_score\":15028.0,\"timezone\":\"Europe\\/London\",\"city\":{\"id\":\"london_gb\",\"name\":\"London\",\"code\":\"LON\",\"slug\":\"london-united-kingdom\",\"nearby_country\":null,\"autonomous_territory\":null,\"continent\":{\"id\":\"europe\",\"name\":\"Europe\",\"slug\":\"europe\",\"code\":\"EU\"},\"country\":{\"id\":\"GB\",\"name\":\"United Kingdom\",\"slug\":\"united-kingdom\",\"code\":\"GB\"},\"region\":{\"id\":\"northern-europe\",\"name\":\"Northern Europe\",\"slug\":\"northern-europe\"},\"subdivision\":null},\"location\":{\"lat\":51.571389,\"lon\":0.695556},\"alternative_departure_points\":[{\"id\":\"LGW\",\"distance\":100.55,\"duration\":4753.8},{\"id\":\"LTN\",\"distance\":106.06,\"duration\":4929.7},{\"id\":\"LHR\",\"distance\":123.42,\"duration\":5786},{\"id\":\"NWI\",\"distance\":163.69,\"duration\":8463.6},{\"id\":\"SOU\",\"distance\":207.09,\"duration\":8967.1},{\"id\":\"BHX\",\"distance\":230.87,\"duration\":10098},{\"id\":\"EMA\",\"distance\":237.71,\"duration\":10135.1},{\"id\":\"BOH\",\"distance\":248.94,\"duration\":10767},{\"id\":\"GB-GRAV-BLUE\",\"distance\":46.03,\"duration\":2530.9},{\"id\":\"LCY\",\"distance\":56.84,\"duration\":3209.3},{\"id\":\"STN\",\"distance\":67.45,\"duration\":3831.5}],\"tags\":[{\"tag\":\"sightseeing\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"famous cities\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"activities\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"events\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"city break\",\"month_to\":-1,\"month_from\":-1}],\"providers\":[1165,1175,1277,1284],\"special\":[{\"id\":\"st-paul-s-cathedral_poi\",\"name\":\"St. Paul's Cathedral\",\"slug\":\"st-paul-s-cathedral\"},{\"id\":\"isle-of-wight_poi\",\"name\":\"Isle of Wight\",\"slug\":\"isle-of-wight\"},{\"id\":\"natural-history-museum_poi\",\"name\":\"Natural History Museum\",\"slug\":\"natural-history-museum\"},{\"id\":\"british-museum_poi\",\"name\":\"British Museum\",\"slug\":\"british-museum\"},{\"id\":\"tate-modern_poi\",\"name\":\"Tate Modern\",\"slug\":\"tate-modern\"},{\"id\":\"canterbury-cathedral_poi\",\"name\":\"Canterbury Cathedral\",\"slug\":\"canterbury-cathedral\"},{\"id\":\"portsea-island_poi\",\"name\":\"Portsea Island\",\"slug\":\"portsea-island\"},{\"id\":\"tower-of-london_poi\",\"name\":\"Tower of London\",\"slug\":\"tower-of-london\"}],\"tourist_region\":[{\"id\":\"greater-london_poi\",\"name\":\"Greater London\",\"slug\":\"greater-london\"}],\"car_rentals\":[{\"provider_id\":1175,\"providers_locations\":[\"679308\"]}],\"new_ground\":false,\"routing_priority\":0,\"type\":\"airport\"},{\"id\":\"ELS\",\"int_id\":8592,\"airport_int_id\":8592,\"active\":true,\"code\":\"ELS\",\"icao\":\"FAEL\",\"name\":\"East London\",\"slug\":\"east-london-east-london-south-africa\",\"slug_en\":\"east-london-east-london-south-africa\",\"alternative_names\":[],\"rank\":705,\"global_rank_dst\":325,\"dst_popularity_score\":26683.0,\"timezone\":\"Africa\\/Johannesburg\",\"city\":{\"id\":\"east-london_za\",\"name\":\"East London\",\"code\":\"ELS\",\"slug\":\"east-london-south-africa\",\"nearby_country\":null,\"autonomous_territory\":null,\"continent\":{\"id\":\"africa\",\"name\":\"Africa\",\"slug\":\"africa\",\"code\":\"AF\"},\"country\":{\"id\":\"ZA\",\"name\":\"South Africa\",\"slug\":\"south-africa\",\"code\":\"ZA\"},\"region\":{\"id\":\"southern-africa\",\"name\":\"Southern Africa\",\"slug\":\"southern-africa\"},\"subdivision\":null},\"location\":{\"lat\":-33.035556,\"lon\":27.825833},\"alternative_departure_points\":[{\"id\":\"UTT\",\"distance\":242.01,\"duration\":11464.4}],\"tags\":[{\"tag\":\"sightseeing\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"family fun\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"activities\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"events\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"city break\",\"month_to\":-1,\"month_from\":-1}],\"providers\":[1175],\"special\":[],\"tourist_region\":[],\"car_rentals\":[{\"provider_id\":1175,\"providers_locations\":[\"19090\",\"657418\"]}],\"new_ground\":false,\"routing_priority\":0,\"type\":\"airport\"},{\"id\":\"YXU\",\"int_id\":6803,\"airport_int_id\":6803,\"active\":true,\"code\":\"YXU\",\"icao\":\"CYXU\",\"name\":\"London International\",\"slug\":\"london-international-london-ontario-canada\",\"slug_en\":\"london-international-london-ontario-canada\",\"alternative_names\":[],\"rank\":1252,\"global_rank_dst\":317,\"dst_popularity_score\":36883.0,\"timezone\":\"America\\/Toronto\",\"city\":{\"id\":\"london_on_ca\",\"name\":\"London\",\"code\":\"YXU\",\"slug\":\"london-ontario-canada\",\"nearby_country\":null,\"autonomous_territory\":null,\"continent\":{\"id\":\"north-america\",\"name\":\"North America\",\"slug\":\"north-america\",\"code\":\"NA\"},\"country\":{\"id\":\"CA\",\"name\":\"Canada\",\"slug\":\"canada\",\"code\":\"CA\"},\"region\":{\"id\":\"northern-america\",\"name\":\"Northern America\",\"slug\":\"northern-america\"},\"subdivision\":{\"id\":\"ON_CA\",\"name\":\"Ontario\",\"slug\":\"ontario-canada\",\"code\":\"ON\"}},\"location\":{\"lat\":43.035556,\"lon\":-81.153889},\"alternative_departure_points\":[{\"id\":\"YKF\",\"distance\":105.15,\"duration\":5377.4},{\"id\":\"CA-LOND-TRAI\",\"distance\":11.81,\"duration\":1098.4},{\"id\":\"YHM\",\"distance\":122.92,\"duration\":5989.6},{\"id\":\"YYZ\",\"distance\":170.28,\"duration\":8330.9},{\"id\":\"YTZ\",\"distance\":187.86,\"duration\":9151.9},{\"id\":\"YQG\",\"distance\":194.1,\"duration\":9177.1},{\"id\":\"IAG\",\"distance\":209.79,\"duration\":10041.5},{\"id\":\"BUF\",\"distance\":242.75,\"duration\":11728.2},{\"id\":\"FNT\",\"distance\":245.77,\"duration\":11210.9},{\"id\":\"CA-INGE-TRAI\",\"distance\":26.19,\"duration\":1836.6},{\"id\":\"CA-STMA-TRAI\",\"distance\":33.41,\"duration\":2243.2},{\"id\":\"CA-WOOD-TRAI\",\"distance\":38.06,\"duration\":2545.7}],\"tags\":[{\"tag\":\"sightseeing\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"family fun\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"activities\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"events\",\"month_to\":-1,\"month_from\":-1},{\"tag\":\"city break\",\"month_to\":-1,\"month_from\":-1}],\"providers\":[1175,1277],\"special\":[],\"tourist_region\":[],\"car_rentals\":[{\"provider_id\":1175,\"providers_locations\":[\"389436\",\"4127\",\"4309372\",\"1314023\"]}],\"new_ground\":false,\"routing_priority\":0,\"type\":\"airport\"}],\"meta\":{\"locale\":{\"code\":\"en-US\",\"status\":\"Locale not specified, using default.\"}},\"last_refresh\":1659004126,\"results_retrieved\":7}";
        TequilaAPIService mockTequilaAPIService = mock(TequilaAPIService.class);
        String searchText = "text";
        FlightsService flightsService = new FlightsService(mockTequilaAPIService);
        when(mockTequilaAPIService.getRequestResponse("https://tequila-api.kiwi.com/locations/query","?term="+searchText+"&location_types=airport"))
                .thenReturn(new HttpEntity<>(tequilaAirportSearchTestResponseJson));

        List<Airport> resultAirports = flightsService.searchAirports(searchText);

        assertEquals(new Airport("Gatwick","LGW","London","United Kingdom"),resultAirports.get(0));
        assertEquals(new Airport("London Stansted","STN","London","United Kingdom"),resultAirports.get(1));
        assertEquals(new Airport("Heathrow","LHR","London","United Kingdom"),resultAirports.get(2));
    }
}
